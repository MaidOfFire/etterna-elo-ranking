# Etterna Elo Ranking

Uses player data to approximate players' **Elo rating**.

## What is Elo rating?

The **Elo rating system** is a method for calculating the relative skill levels of players. Elo assigns players numeric ratings that increase or decrease based on wins, losses, and draws against opponents. 

Higher Elo indicates higher skill, and differences in ratings predict the outcome probabilities of matches between players.

## Rating Table
_Last updated: May 21, 2025_

|                  |   overall |   stream |   jumpstream |   handstream |   chordjacks |   technical |
|:-----------------|----------:|---------:|-------------:|-------------:|-------------:|------------:|
| Saragi           |      2484 |     2544 |         2437 |         2440 |         2467 |        2035 |
| puyihari         |      2396 |     2485 |         2314 |         2389 |         2264 |        2129 |
| YumaOs           |      2297 |     2293 |         2313 |         2287 |         2001 |        1906 |
| AnMaO            |      2258 |     2363 |         2219 |         2191 |         1773 |        2084 |
| jja              |      2252 |     2258 |         2278 |         2219 |         2023 |        2032 |
| maya             |      2245 |     2354 |         2128 |         2253 |         1948 |        2068 |
| gongorirel       |      2226 |     2125 |         2280 |         2274 |         1521 |        1710 |
| marilyy          |      2174 |     2286 |         2011 |         2066 |         1566 |        2169 |
| selrrrrr         |      2168 |     1886 |         2283 |         2210 |         2010 |        1926 |
| Devplayzz        |      2153 |     2155 |         2136 |         1962 |         1564 |        2168 |
| clerpy           |      2128 |     2187 |         2128 |         2070 |         2000 |        2039 |
| SillyFangirl     |      2119 |     2020 |         2175 |         2113 |         2063 |        2068 |
| paocompaoepaa    |      2080 |     2240 |         1748 |         2063 |         1612 |        1937 |
| waterquality     |      2044 |     1924 |         2153 |         2056 |         1770 |        1923 |
| na2304           |      2034 |     2027 |         1640 |         1876 |         2104 |        1971 |
| almond           |      2030 |     2127 |         1931 |         2030 |         1730 |        1802 |
| Bistulex         |      2025 |     2084 |         1982 |         2009 |         1835 |        1864 |
| Nico777playz     |      2004 |     1978 |         1973 |         1861 |         2060 |        1912 |
| Abyss            |      2002 |     1885 |         2095 |         2027 |         1698 |        1664 |
| Kyuui            |      1994 |     1934 |         1929 |         1654 |         2049 |        1999 |
| vibong           |      1974 |     1973 |         1883 |         1779 |         2065 |        1793 |
| COmp             |      1973 |     1966 |         2066 |         1886 |         1764 |        1743 |
| muelsyse         |      1966 |     1861 |         2119 |         1917 |         1836 |        1828 |
| DanTDM           |      1961 |     2009 |         1799 |         1885 |         1843 |        1988 |
| 23Marzo          |      1961 |     1946 |         1991 |         1945 |         1619 |        1650 |
| Delusion         |      1952 |     1918 |         1915 |         2022 |         1662 |        1834 |
| Kuruche          |      1949 |     2062 |         1929 |         1856 |         1619 |        1803 |
| Noraa            |      1945 |     1909 |         2058 |         1803 |         1805 |        1870 |
| skadi            |      1933 |     1909 |         1943 |         1948 |         1867 |        1754 |
| TristanJacob9    |      1931 |     1947 |         1744 |         1828 |         1904 |        1941 |
| googlekub455     |      1931 |     2070 |         1871 |         1639 |         1607 |        1851 |
| vaydex           |      1918 |     1440 |         1872 |         1656 |         2226 |        1505 |
| Voezux           |      1916 |     2066 |         1772 |         1910 |         1665 |        1584 |
| DeltaEquals84    |      1911 |     2099 |         1704 |         1770 |         1416 |        1864 |
| Meatloaf         |      1909 |     2123 |         1786 |         1817 |         1485 |        1706 |
| snoverpk         |      1899 |     1920 |         1910 |         1863 |         1665 |        1866 |
| Trescendence     |      1897 |     1880 |         1873 |         1796 |         1826 |        1936 |
| malicieux        |      1894 |     1844 |         1864 |         1974 |         1591 |        1670 |
| SOYNEBUV2        |      1884 |     1869 |         1810 |         1973 |         1704 |        1614 |
| yumaTV           |      1883 |     1882 |         1987 |         1760 |         1780 |        1668 |
| Dystire          |      1882 |     1946 |         1773 |         1841 |         1514 |        1861 |
| Guilherme        |      1880 |     1751 |         1582 |         1795 |         1953 |        1893 |
| Monheim          |      1874 |     1621 |         1693 |         1738 |         2145 |        1739 |
| hsod             |      1873 |     1645 |         1958 |         1869 |         1792 |        1768 |
| Vanstav          |      1856 |     2216 |         1583 |         1535 |         1547 |        1769 |
| Shadow           |      1854 |     1965 |         1749 |         1701 |         1599 |        1848 |
| breadles         |      1850 |     1861 |         1516 |         1652 |         1860 |        1830 |
| theman234tonk    |      1847 |     1857 |         1885 |         1790 |         1561 |        1799 |
| p6yb             |      1847 |     1793 |         2045 |         1545 |         1703 |        1627 |
| Tevelkin         |      1845 |     1714 |         1826 |         1798 |         1484 |        1911 |
| Wateh            |      1845 |     1825 |         1719 |         1881 |         1595 |        1829 |

Full table (271 player) [here](/output/elo_dtw_ord_skillsets.md). Peak rating table [here](/output/elo_dtw_ord_peak_skillsets.md). 

Note that because the player pool was much smaller in earlier years, Elo inflation occurs quickly.
Ratings achieved in different eras are therefore generally not comparable.

---

## How matches are constructed:

Player scores are filtered leaving only scores with accuracy between **96% and 99.7%**.

For each chart and skillset (e.g., `stream`, `jumpstream`, `handstream` (defined as largest MSD)), player scores are matched as follows:

- When a player achieves a **new score** on a chart, it is paired against the **current personal best scores** of all other players on the same chart.
- Each pairing becomes one "match". 

All pairs from the same new personal best are processed as a single batch: player's rating update is accumulated and applied once after all comparisons.

The outcome of a match is a continuous score $S_A \in [0,1]$ for player A
computed from two differences:

```math
x_1 = \log\!\Bigl(\tfrac{\text{rate}_A}{\text{rate}_B}\Bigr), 
\qquad
x_2 = \text{WIFE}_A - \text{WIFE}_B
```

These inputs feed a logistic curve:

```math
S_A = \sigma\!\bigl(\alpha \, x_1 + \beta \, x_2\bigr),
\quad \sigma(z)=\frac{1}{1 + e^{-z}}
```

where $\alpha$ and $\beta$ are tunable parameters, determining equivalence of different (rate, wife) pairs (see [this](/scripts/explore_params.ipynb)).

## Elo Update formula:

The Elo ratings are updated after each match using the standard Elo formula, with an additional **time-decay parameter ($\tau$)** that gives less weight to matches where player scores are far apart in time:

```math
R_{A,\text{new}} = R_{A,\text{old}} + K_{\text{eff}} \cdot (S_A - E_A)
```

where:

- $R_{A,\text{old}}$ and $R_{A,\text{new}}$ are player A’s Elo ratings before and after the match.
- $K_{\text{eff}}$ is the effective K-factor adjusted by time-decay:
  
```math
K_{\text{eff}} = K \cdot e^{-\Delta / \tau}
```

  Here:
  - $K$ is the base update step (typically 10–30).
  - $\Delta$ is the absolute difference in days between the two matched scores.
  - $\tau$ (**tau parameter**) controls how quickly the weight decays with time (measured in days). Larger values of $\tau$ mean slower decay; set $\tau = \infty$ to disable time decay entirely.

- $S_A$ is the actual score from the match.
- $E_A$ is the expected score, calculated as:
  
```math
E_A = \frac{1}{1 + 10^{(R_B - R_A)/400}}
```

A large Elo difference reduces the rating changes for expected outcomes, while close-in-time matches have a stronger effect on ratings compared to matches separated by long periods.


## Running the code:

Install [UV](https://docs.astral.sh/uv/).

Initialize the project environment:
```bash
uv init
uv venv
uv sync
```

Download scores from the EtternaOnline:
```bash
uv run scripts/scrapper.py
```
Or from [releases](https://github.com/MaidOfFire/etterna-elo-ranking/releases)

Run Elo rating script:
```bash
uv run scripts/run_elo.py
```

Results will appear under the output/ directory

## Charts Elo difficulty

In addition to player ratings, the pipeline also assigns each chart a difficulty score by estimating the Elo a player would need to achieve 93% WIFE at 1.0× rate, assuming a linear relationship between rate and Elo (e.g. 1.0× ~ 1000 elo, 1.2× ~ 1200 elo, etc.).


**_msd_overrated_**, a very rough estimation of whether the chart overrated (> 1.0) or underrated (< 1.0) in terms of MDS.

Sample of chart difficulty table:

|   chart_id |   elo_diff |   msd_overrated | skillset   | chart_name                                                                                                                                                                                                                                                                                  |
|-----------:|-----------:|----------------:|:-----------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     315220 |    2087.82 |          0.7743 | technical  | ('TRICKL4SH 220', 'TESTOPACK')                                                                                                                                                                                                                                                              |
|     315268 |    2074.09 |          0.9415 | technical  | ('Death Waltz', 'TESTOPACK')                                                                                                                                                                                                                                                                |
|     256591 |    2035.12 |          0.5713 | technical  | ('attang', "Bunch of Files You Probably Don't Have 4")                                                                                                                                                                                                                                      |
|     270333 |    1934    |          0.8718 | technical  | ('Cyber Induction', 'Grape Cola 2')                                                                                                                                                                                                                                                         |
|     254283 |    1891.65 |          0.8652 | technical  | ('DATA DRAIN', 'Blurk')                                                                                                                                                                                                                                                                     |
|     342852 |    1873.76 |          0.9033 | technical  | ('Grilletto', 'interesting files i found in my discord dms')                                                                                                                                                                                                                                |
|     285259 |    1850.71 |          0.8553 | technical  | ('The Marriage of Figaro', 'Minty zFarts Pack 1')                                                                                                                                                                                                                                           |
|     315246 |    1817.07 |          0.8838 | technical  | ('Gamble', 'TESTOPACK')                                                                                                                                                                                                                                                                     |
|     282124 |    1811.04 |          0.9312 | technical  | ('[Penultimate] Faint', 'Lofty Dump Minipack 3 (Xclusive Edition)')                                                                                                                                                                                                                         |
|     271686 |    1807.79 |          0.9127 | technical  | ('Shotgun Senorita (Zardonic Remix)', 'hi19hi19 Pack 5 - Streams and Memes')                                                                                                                                                                                                                |
|     250488 |    1807.33 |          0.8803 | technical  | ('Tape Worm', 'Anime Sucks Ass  3')                                                                                                                                                                                                                                                         |
|     327874 |    1803.86 |          0.8347 | technical  | ('Nostos 2022', "Vela's Velato v2 - Escape From Reality")                                                                                                                                                                                                                                   |
|     285731 |    1794.65 |          0.5457 | technical  | ('Distorted Reality', 'Mina Minimegapack 4')                                                                                                                                                                                                                                                |
|     256429 |    1779.93 |          0.5813 | technical  | ('DASTER', "Bunch of Files You Probably Don't Have 5 -OLD SCHOOL EDITION-")                                                                                                                                                                                                                 |
|     285719 |    1777.68 |          0.9301 | technical  | ('Push it to the Limit v2', 'Mina Minimegapack 4')                                                                                                                                                                                                                                          |
|     251954 |    1773.31 |          0.9372 | technical  | ('FREEDOM DIVE - GAMMA DIMENSION-', "ATTang's Bad Files")                                                                                                                                                                                                                                   |
|     338700 |    1766.24 |          1.0169 | technical  | ("Can't Let Go", 'Polarin Pack 5')                                                                                                                                                                                                                                                          |
|     285261 |    1756.51 |          0.8357 | technical  | ('Doge Adventure', 'Minty zFarts Pack 1')                                                                                                                                                                                                                                                   |
|     315289 |    1754.95 |          0.9078 | technical  | ('Dekoboko speedster', 'TESTOPACK')                                                                                                                                                                                                                                                         |
|     251921 |    1745.8  |          0.8889 | technical  | ('Palette GAMMA', 'ATTangs Dumpmix')                                                                                                                                                                                                                                                        |
|     285513 |    1728.48 |          0.8282 | technical  | ('Juju on that Beat', 'Minty Fresh Pack 1')                                                                                                                                                                                                                                                 |
|     304692 |    1716.88 |          0.8404 | technical  | ("Cloud Nimbus' Op", 'Shadormix')                                                                                                                                                                                                                                                           |
|     302129 |    1713.63 |          0.5736 | technical  | ('Arch0wl', 'Rebound Vibrajacking Pack')                                                                                                                                                                                                                                                    |

Full table (4862 chart) [here](/output/chart_elo_diff.md).


