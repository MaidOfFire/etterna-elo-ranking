# Etterna Elo Ranking

Uses player data to approximate players' **Elo rating**.

## What is Elo rating?

The **Elo rating system** is a method for calculating the relative skill levels of players. Elo assigns players numeric ratings that increase or decrease based on wins, losses, and draws against opponents. 

Higher Elo indicates higher skill, and differences in ratings predict the outcome probabilities of matches between players.

## Rating Table
_Last updated: Jul 5, 2025_

|                  |   overall |   stream |   jumpstream |   handstream |   chordjacks |   technical |
|:-----------------|----------:|---------:|-------------:|-------------:|-------------:|------------:|
| Saragi           |      2564 |     2658 |         2530 |         2505 |         2495 |        2086 |
| puyihari         |      2486 |     2584 |         2407 |         2468 |         2317 |        2164 |
| YumaOs           |      2410 |     2391 |         2438 |         2403 |         2102 |        1959 |
| AnMaO            |      2363 |     2479 |         2340 |         2270 |         1877 |        2138 |
| waterquality     |      2342 |     2408 |         2339 |         2280 |         2090 |        1711 |
| jja              |      2339 |     2367 |         2360 |         2290 |         2094 |        2048 |
| maya             |      2326 |     2481 |         2187 |         2309 |         2011 |        2092 |
| marilyy          |      2254 |     2375 |         2145 |         2132 |         1603 |        2241 |
| gongorirel       |      2241 |     2036 |         2351 |         2335 |         1616 |        1748 |
| selrrrrr         |      2239 |     2050 |         2361 |         2289 |         2068 |        1993 |
| Devplayzz        |      2226 |     2214 |         2228 |         2001 |         1568 |        2236 |
| SillyFangirl     |      2159 |     2012 |         2259 |         1923 |         2114 |        2105 |
| Nico777playz     |      2151 |     2092 |         2198 |         1920 |         2161 |        2043 |
| paocompaoepaa    |      2148 |     2315 |         1797 |         2150 |         1712 |        1979 |
| clerpy           |      2138 |     2099 |         2195 |         2120 |         2057 |        2085 |
| Kuruche          |      2109 |     2308 |         2096 |         1923 |         1667 |        1783 |
| Bistulex         |      2108 |     2172 |         2079 |         2072 |         1903 |        1796 |
| na2304           |      2097 |     2095 |         1662 |         1925 |         2182 |        2016 |
| Arcine           |      2097 |     2093 |         2102 |         2095 |         1896 |        1995 |
| Abyss            |      2090 |     1972 |         2179 |         2119 |         1774 |        1742 |
| almond           |      2078 |     2205 |         1996 |         2033 |         1789 |        1874 |
| 23Marzo          |      2074 |     2170 |         2020 |         2033 |         1784 |        1899 |
| Meatloaf         |      2072 |     2034 |         2078 |         2102 |         1488 |        1854 |
| muelsyse         |      2064 |     2049 |         2111 |         2031 |         1826 |        1827 |
| Kyuui            |      2063 |     2022 |         2029 |         1674 |         2108 |        2052 |
| yeb              |      2055 |     2271 |         1936 |         1956 |         1837 |        1715 |
| Noraa            |      2048 |     1977 |         2190 |         1918 |         1898 |        1976 |
| vibong           |      2044 |     1989 |         1988 |         2042 |         2101 |        1881 |
| bunny            |      2044 |     2163 |         2063 |         1904 |         1588 |        1817 |
| DanTDM           |      2042 |     2088 |         2066 |         1899 |         1858 |        1972 |
| COmp             |      2037 |     2125 |         2022 |         1964 |         1788 |        1875 |
| Delusion         |      2036 |     2024 |         1977 |         2105 |         1705 |        1905 |
| skadi            |      2030 |     1999 |         2053 |         2038 |         1946 |        1793 |
| SOYNEBUV2        |      2024 |     2178 |         1857 |         2036 |         1781 |        1727 |
| snoverpk         |      2006 |     2009 |         2044 |         1964 |         1771 |        1961 |
| malicieux        |      2001 |     1916 |         2010 |         2077 |         1710 |        1726 |
| vaydex           |      1995 |     1556 |         2002 |         1785 |         2199 |        1596 |
| Voezux           |      1995 |     2106 |         1880 |         1999 |         1737 |        1634 |
| googlekub455     |      1993 |     2141 |         1922 |         1673 |         1632 |        1915 |
| Tanmanguy7       |      1991 |     1944 |         2092 |         1753 |         1883 |        1937 |
| TristanJacob9    |      1986 |     2002 |         1719 |         1906 |         1972 |        1983 |
| Trescendence     |      1979 |     1970 |         1998 |         1878 |         1914 |        1969 |
| hsod             |      1977 |     1783 |         2068 |         1981 |         1883 |        1848 |
| yumaTV           |      1975 |     1950 |         2099 |         1795 |         1875 |        1756 |
| satori           |      1957 |     2236 |            0 |         1823 |         1729 |        1813 |
| theman234tonk    |      1957 |     1998 |         1984 |         1888 |         1636 |        1888 |
| Monheim          |      1951 |     1753 |         1837 |         1818 |         2197 |        1799 |
| Thiago           |      1949 |     1924 |         1966 |         1957 |         1819 |        1744 |
| sim0             |      1948 |     1903 |         2038 |         1836 |         1685 |        1905 |
| Dystire          |      1948 |     2045 |         1886 |         1888 |         1512 |        1912 |
| Shadow           |      1939 |     2066 |         1851 |         1787 |         1707 |        1899 |

Full table (400 players) [here](/output/elo_dtw_ord_skillsets.md). Peak rating table [here](/output/elo_dtw_ord_peak_skillsets.md). 

Note that because the player pool was much smaller in earlier years, Elo inflation occurs quickly.
Ratings achieved in different eras are therefore generally not comparable.

---

## How matches are constructed:

Player scores are filtered leaving only scores with accuracy between **89.0% and 99.0%**.

For each chart and skillset (e.g., `stream`, `jumpstream`, `handstream` (defined as largest MSD)), player scores are matched as follows:

- When a player achieves a **new score** on a chart, it is paired against the **current personal best scores** of all other players on the same chart.
- Each pairing becomes one "match". 

All pairs from the same new personal best are processed as a single batch: player's rating update is accumulated and applied once after all comparisons.

The outcome of a match is a continuous score $S_A \in [0,1]$ for player A
computed from two differences:

```math
x_1 = \log\!\Bigl(\tfrac{\text{rate}_A}{\text{rate}_B}\Bigr), 
\qquad
x_2 = \text{WIFE}_A - \text{WIFE}_B
```

These inputs feed a logistic curve:

```math
S_A = \sigma\!\bigl(\alpha \, x_1 + \beta \, x_2\bigr),
\quad \sigma(z)=\frac{1}{1 + e^{-z}}
```

where $\alpha$ and $\beta$ are tunable parameters, determining equivalence of different (rate, wife) pairs (see [this](/scripts/explore_params.ipynb)).

## Elo Update formula:

The Elo ratings are updated after each match using the standard Elo formula, with an additional **time-decay parameter ($\tau$)** that gives less weight to matches where player scores are far apart in time:

```math
R_{A,\text{new}} = R_{A,\text{old}} + K_{\text{eff}} \cdot (S_A - E_A)
```

where:

- $R_{A,\text{old}}$ and $R_{A,\text{new}}$ are player A’s Elo ratings before and after the match.
- $K_{\text{eff}}$ is the effective K-factor adjusted by time-decay:
  
```math
K_{\text{eff}} = K \cdot e^{-\Delta / \tau}
```

  Here:
  - $K$ is the base update step (typically 10–30).
  - $\Delta$ is the absolute difference in days between the two matched scores.
  - $\tau$ (**tau parameter**) controls how quickly the weight decays with time (measured in days). Larger values of $\tau$ mean slower decay; set $\tau = \infty$ to disable time decay entirely.

- $S_A$ is the actual score from the match.
- $E_A$ is the expected score, calculated as:
  
```math
E_A = \frac{1}{1 + 10^{(R_B - R_A)/400}}
```

A large Elo difference reduces the rating changes for expected outcomes, while close-in-time matches have a stronger effect on ratings compared to matches separated by long periods.


## Running the code:

Install [UV](https://docs.astral.sh/uv/).

Initialize the project environment:
```bash
uv init
uv venv
uv sync
```

Download scores from the EtternaOnline:
```bash
uv run scripts/scrapper.py
```
Or from [releases](https://github.com/MaidOfFire/etterna-elo-ranking/releases)

Run Elo rating script:
```bash
uv run scripts/run_elo.py
```

Results will appear under the output/ directory

## Charts Elo difficulty

In addition to player ratings, the pipeline also assigns each chart a difficulty score by estimating the Elo a player would need to achieve 93% WIFE at 1.0× rate, assuming a linear relationship between rate and Elo (e.g. 1.0× ~ 1000 elo, 1.2× ~ 1200 elo, etc.).


**_msd_overrated_**, a very rough estimation of whether the chart overrated (> 1.0) or underrated (< 1.0) in terms of MDS.

Sample of chart difficulty table:

|   chart_id |   elo_diff |   msd_overrated | skillset   | chart_name                                                                                                                                                                                                                                                                                                                                             |
|-----------:|-----------:|----------------:|:-----------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     367792 |    1662.65 |          1.3272 | technical  | ('Orange Blossom Train Tracks', "Vela's Velato")                                                                                                                                                                                                                                                                                                       |
|     367791 |    1673.45 |          1.3166 | technical  | ('Orange Blossom Train Tracks', "Vela's Velato")                                                                                                                                                                                                                                                                                                       |
|     342388 |    1463.27 |          1.1653 | technical  | ('Nageki no Ki', 'April Singles')                                                                                                                                                                                                                                                                                                                      |
|     316743 |    1094.71 |          1.165  | chordjacks | ('gazer', 'Super Polska Chordjack #1')                                                                                                                                                                                                                                                                                                                 |
|     327852 |    1402.68 |          1.162  | technical  | ('Misery', "Vela's Velato v2 - Escape From Reality")                                                                                                                                                                                                                                                                                                   |
|     309114 |    1458.02 |          1.1603 | chordjacks | ('KANE TAJIRI', 'SMOC EXTRA')                                                                                                                                                                                                                                                                                                                          |
|     263267 |    2136.5  |          1.1577 | chordjacks | ('InfinitY Happy END-', 'Einar Final')                                                                                                                                                                                                                                                                                                                 |
|     327862 |    1069    |          1.1561 | technical  | ('Tren al Sur', "Vela's Velato v2 - Escape From Reality")                                                                                                                                                                                                                                                                                              |
|     341632 |    1041.63 |          1.1547 | handstream | ('Hachigatsu no Yoru', 'This Could Have Been Your Pack')                                                                                                                                                                                                                                                                                               |
|     254613 |    1275.18 |          1.1534 | jumpstream | ('Sky Is The Limit for jumptrill', 'Blos Pack 5')                                                                                                                                                                                                                                                                                                      |
|     339014 |     970.15 |          1.1497 | technical  | ('Not Holding Back', 'Polarin Pack 4')                                                                                                                                                                                                                                                                                                                 |
|     331128 |    1751.05 |          1.1473 | stream     | ('REIMU2RAVE', 'mizuki')                                                                                                                                                                                                                                                                                                                               |
|     357994 |    1395.86 |          1.1467 | technical  | ('Nadia', 'Demure Dumps')                                                                                                                                                                                                                                                                                                                              |
|     354670 |    1284.63 |          1.1379 | technical  | ('Behind Bars', 'Valedumps 4')                                                                                                                                                                                                                                                                                                                         |
|     324317 |    1467.6  |          1.1371 | technical  | ('GET HYPER (Radio Edit)', 'Volvo Gaming Pack 2')                                                                                                                                                                                                                                                                                                      |
|     354626 |    1423.46 |          1.1354 | technical  | ('Sarigiwa no Romantics', 'Valedumps 4')                                                                                                                                                                                                                                                                                                               |
|     350637 |    1452.75 |          1.1347 | technical  | ('Parallel Universe Shifter', 'Helvetica Standard')                                                                                                                                                                                                                                                                                                    |
|     315273 |    1599.03 |          1.1343 | technical  | ('Holdin On (Skrillex and Nero Remix)', 'TESTOPACK')                                                                                                                                                                                                                                                                                                   |
|     339324 |    1550.2  |          1.1341 | technical  | ('Apetenodytes Disco Type.4.0', 'Grape Cola 3')                                                                                                                                                                                                                                                                                                        |
|     343984 |    1668.54 |          1.1335 | chordjacks | ('GO', 'Super Polska Chordjack #4')                                                                                                                                                                                                                                                                                                                    |
|     339350 |    1505.73 |          1.1325 | technical  | ('雲散霧消', 'Grape Cola 3')                                                                                                                                                                                                                                                                                                                           |
|     357856 |    1309.01 |          1.1322 | chordjacks | ('Dat Phonk', '01 - Super Argento Chordjack')                                                                                                                                                                                                                                                                                                          |
|     343873 |    1316.73 |          1.1316 | jumpstream | ('Disconnected Trance', "Restia's Backroom 22")                                                                                                                              
                                                                                                                              
Full table (5307 charts) [here](/output/chart_elo_diff.md).


